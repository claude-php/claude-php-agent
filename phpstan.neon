parameters:
    level: 6
    paths:
        - src
    excludePaths:
        - vendor
    tmpDir: build/phpstan
    treatPhpDocTypesAsCertain: false
    ignoreErrors:
        # Ignore missing generic/iterable value types for flexibility
        -
            identifier: missingType.iterableValue
        -
            identifier: missingType.generics
        # Properties that are intentionally write-only (for future use or extensions)
        -
            message: '#Property .* is never read, only written#'
        # Allow nullable implicit parameters (legacy PHP compatibility)
        -
            message: '#Parameter .* is implicitly nullable via default value null#'
        # Redis/Predis optional dependency
        -
            message: '#unknown class Predis\\Client#'
        # AMPHP template type resolution (library limitation)
        -
            message: '#Unable to resolve the template type#'
        # Allow PSR-3 logger implementations without strict types
        -
            message: '#Method .* has parameter \$message with no type specified#'
            path: src/Chains/Chain.php
        -
            message: '#Method .* has parameter \$message with no type specified#'
            path: src/Observability/ObservabilityLogger.php
        -
            message: '#Method .* has parameter \$level with no type specified#'
        # Parser factory dynamic method calls
        -
            message: '#Call to an undefined method .*ParserInterface#'
            path: src/Parsers/ParserFactory.php
        # Function not found (Laravel helper, can be safely ignored)
        -
            message: '#Function class_basename not found#'
            path: src/Tools/Tool.php
        # Null coalescing on array offsets that always exist (defensive coding)
        -
            message: '#Offset .* on .* on left side of \?\? always exists and is not nullable#'
        # Isset checks on array offsets (defensive coding)
        -
            message: '#Offset .* on .* in isset\(\) always exists and is not nullable#'
        # Strict type comparisons with PHPDoc types
        -
            message: '#Strict comparison using .* will always evaluate to (true|false)#'
        # Unused parameters in closures/callbacks (may be required by interface)
        -
            message: '#Anonymous function has an unused use#'
        # Negated boolean expressions (defensive coding)
        -
            message: '#Negated boolean expression is always (true|false)#'
        # While true loops (intentional infinite loops with breaks)
        -
            message: '#While loop condition is always true#'
        # Comparison operations that are always true/false (defensive coding)
        -
            message: '#Comparison operation .* is always (true|false)#'
        # Missing type specifications for callback properties
        -
            message: '#Property .* has no type specified#'
        # Method parameter without type (for flexibility in some cases)
        -
            message: '#Method .* has parameter .* with no type specified#'
        # Call to is_string with array (defensive type checking)
        -
            message: '#Call to function is_string\(\) with array will always evaluate to false#'
        # PHPDoc tag issues
        -
            message: '#PHPDoc tag @throws with type .* is not subtype of Throwable#'
        # Return type mismatches (async operations complexity)
        -
            message: '#Method .* should return .* but returns#'
        # AgentContext array offset issues (dynamic context structure)
        -
            message: '#Offset .* does not exist on array\{messages: array, iteration: int, timestamp: float\}#'
            path: src/AgentContext.php
        # Redis type issues (optional dependency)
        -
            message: '#Parameter \$redis of method .*RedisDocumentStore.*has invalid type Predis\\Client#'
        -
            message: '#Comparison operation .* between \(bool\|int\|Redis\) and 0 results in an error#'
            path: src/RAG/Storage/RedisDocumentStore.php

